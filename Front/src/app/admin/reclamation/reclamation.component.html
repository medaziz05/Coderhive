<html class="no-js" lang="zxx">

<head>
    <link rel="icon" href="assets/images/favicon.ico" type="image/x-icon">
</head>

<body>

    <div class="fix">
        <div class="bd-offcanvas-area">
            <div class="bd-offcanvas-wrapper">
                <div class="bd-offcanvas-content">
                    <div class="bd-offcanvas-top d-flex justify-content-between align-items-center mb-30">
                        <div class="bd-offcanvas-logo">
                            <a href="index.html">
                                <img src="assets/images/logo/logo.svg" alt="logo not found">
                            </a>
                        </div>
                        <div class="bd-offcanvas-close">
                            <button class="bd-offcanvas-close-icon animation--flip">
                                <span class="bd-offcanvas-m-lines">
                                <span class="bd-offcanvas-m-line line--1"></span><span
                                    class="bd-offcanvas-m-line line--2"></span><span
                                    class="bd-offcanvas-m-line line--3"></span>
                                </span>
                            </button>
                        </div>
                    </div>
                    <div class="bd-offcanvas-search mb-30">
                        <form action="#">
                            <input type="text" name="bd-offcanvasSearch" placeholder="Search here">
                            <button type="submit"><i class="fa-solid fa-magnifying-glass"></i></button>
                        </form>
                    </div>
                    <div class="bd-mobile-menu-smaller">
                        <div class="bd-offcanvas-menu mb-30">
                            <nav></nav>
                        </div>
                    </div>
                    <div class="bd-offcanvas-about d-none d-lg-block mb-30">
                        <h4 class="bd-offcanvas-title-meta">About iStudy</h4>
                        <p>Empowering learners and educators with a comprehensive platform that bridges the gap between traditional and modern education. iStudy inspires excellence in education and fosters growth for a brighter future.</p>
                    </div>
                    <div class="bd-offcanvas-contact mb-30">
                        <h4 class="bd-offcanvas-title-meta">Contact Info</h4>
                        <ul>
                            <li class="d-flex align-items-center gap-10">
                                <div class="bd-offcanvas-contact-icon">
                                    <a target="_blank" href="#">
                                        <i class="fal fa-map-marker-alt"></i></a>
                                </div>
                                <div class="bd-offcanvas-contact-text">
                                    <a target="_blank" href="#">123 Knowledge Lane, Learnville, 54321, USA</a>
                                </div>
                            </li>
                            <li class="d-flex align-items-center gap-10">
                                <div class="bd-offcanvas-contact-icon">
                                    <a href="tel:+1234567890"><i class="far fa-phone"></i></a>
                                </div>
                                <div class="bd-offcanvas-contact-text">
                                    <a href="tel:+1234567890">+1-234-567-890</a>
                                </div>
                            </li>
                            <li class="d-flex align-items-center gap-10">
                                <div class="bd-offcanvas-contact-icon">
                                    <a href="mailto:info@istudy.com"><i class="fal fa-envelope"></i></a>
                                </div>
                                <div class="bd-offcanvas-contact-text">
                                    <a href="mailto:info@istudy.com">info  istudy.com</a>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="bd-offcanvas-btn-wrap mb-30">
                        <h4 class="bd-offcanvas-title-meta">Account</h4>
                        <div class="bd-offcanvas-btn d-flex align-items-center gap-30">
                            <a class="bd-btn btn-primary" href="sign-in.html">Log In</a>
                            <a class="bd-btn btn-outline-border-secondary" href="sign-up.html">Get Started</a>
                        </div>
                    </div>
                    <div class="bd-offcanvas-social">
                        <h4 class="bd-offcanvas-title-meta">Follow Us</h4>
                        <div class="theme-social">
                            <ul class="social-icon-list">
                                <li><a href="#"><i class="fa-brands fa-facebook-f"></i></a></li>
                                <li><a href="#"><i class="fa-brands fa-x-twitter"></i></a></li>
                                <li><a href="#"><i class="fa-brands fa-linkedin-in"></i></a></li>
                                <li><a href="#"><i class="fa-brands fa-instagram"></i></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="bd-offcanvas-overlay"></div>
    <div class="bd-offcanvas-overlay-white"></div>
    <!-- Offcanvas area start -->

    <!-- search popup area start here  -->
    <div class="bd-search-popup-area">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="bd-search-popup">
                        <div class="bd-search-form">
                            <form action="#">
                                <div class="bd-search-input">
                                    <input type="search" name="search" placeholder="Type here to search ...">
                                    <div class="bd-search-submit">
                                        <button type="submit"><i class="fa-regular fa-magnifying-glass"></i></button>
                                    </div>
                                </div>
                            </form>
                            <div class="bd-search-close">
                                <div class="bd-search-close-btn">
                                    <button><i class="fa-thin fa-close"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- search popup overlay  -->
    <div class="bd-search-overlay"></div>
    <!-- search popup area end here  -->

    <!-- search popup area start here  -->
    <div class="bd-sidebar-cart-area">
        <div class="bd-sidebar-cart-wrapper d-flex justify-content-between flex-column">
            <div class="bd-sidebar-cart-top-wrapper">
                <div class="bd-sidebar-cart-top p-relative">
                    <div class="bd-sidebar-cart-top-title">
                        <h5>Shopping cart</h5>
                    </div>
                    <div class="bd-sidebar-cart-close">
                        <button type="button" class="bd-sidebar-cart-close-btn cartmini-close-btn"><i class="fa-solid fa-xmark"></i></button>
                    </div>
                </div>
                <div class="bd-sidebar-cart-widget">
                    <div class="bd-sidebar-cart-widget-item">
                        <div class="bd-sidebar-cart-thumb">
                            <a href="shop-details.html">
                                <img src="assets/images/book/book-cover-2.webp" alt="image">
                            </a>
                        </div>
                        <div class="bd-sidebar-cart-content">
                            <h5 class="bd-sidebar-cart-title"><a href="shop-details.html">We Solve Murders</a></h5>
                            <div class="bd-sidebar-cart-price-wrapper">
                                <span class="bd-sidebar-cart-price">$30.00</span>
                                <span class="bd-sidebar-cart-quantity">x1</span>
                            </div>
                        </div>
                        <a href="#" class="bd-sidebar-cart-del"><i class="fa-regular fa-xmark"></i></a>
                    </div>
                    <div class="bd-sidebar-cart-widget-item">
                        <div class="bd-sidebar-cart-thumb">
                            <a href="shop-details.html">
                                <img src="assets/images/book/book-cover-3.webp" alt="image">
                            </a>
                        </div>
                        <div class="bd-sidebar-cart-content">
                            <h5 class="bd-sidebar-cart-title"><a href="shop-details.html">The Women</a></h5>
                            <div class="bd-sidebar-cart-price-wrapper">
                                <span class="bd-sidebar-cart-price">$30.00</span>
                                <span class="bd-sidebar-cart-quantity">x1</span>
                            </div>
                        </div>
                        <a href="#" class="bd-sidebar-cart-del"><i class="fa-regular fa-xmark"></i></a>
                    </div>
                    <div class="bd-sidebar-cart-widget-item">
                        <div class="bd-sidebar-cart-thumb">
                            <a href="shop-details.html">
                                <img src="assets/images/book/book-cover-4.webp" alt="image">
                            </a>
                        </div>
                        <div class="bd-sidebar-cart-content">
                            <h5 class="bd-sidebar-cart-title"><a href="shop-details.html">Fourth Wing</a></h5>
                            <div class="bd-sidebar-cart-price-wrapper">
                                <span class="bd-sidebar-cart-price">$50.00</span>
                                <span class="bd-sidebar-cart-quantity">x1</span>
                            </div>
                        </div>
                        <a href="#" class="bd-sidebar-cart-del"><i class="fa-regular fa-xmark"></i></a>
                    </div>
                </div>

                <!-- empty cart for wordpress -->
                <div class="bd-sidebar-cart-empty text-center d-none">
                    <img src="assets/images/shop/empty-cart.webp" alt="image">
                    <p>Your Cart is empty</p>
                    <a href="shop.html" class="bd-btn btn-primary">Go to Shop</a>
                </div>
                <!-- empty cart for wordpress -->

            </div>
            <div class="bd-sidebar-cart-checkout">
                <div class="bd-sidebar-cart-checkout-title mb-30">
                    <h5>Subtotal:</h5>
                    <span>$160.00</span>
                </div>
                <div class="bd-sidebar-cart-checkout-btn">
                    <a class="bd-btn btn-primary mb-15 w-100" href="cart.html">View Cart</a>
                    <a class="bd-btn btn-secondary w-100" href="checkout.html">Checkout</a>
                </div>
            </div>
        </div>
    </div>
    <div class="body-overlay"></div>
    <!-- search popup area end here  -->

    <!-- Body main wrapper start -->
    <main>

        <!-- dashboard breadcrumb start -->
        <div class="bd-dashboard-breadcrumb section-space-small-top">

        </div>
        <!-- dashboard breadcrumb end -->

        <!-- Start student Dashboard Area -->
        <div class="bd-dashboard-area section-space-bottom">
            <div class="container">
                <div class="bd-dashboard-main">
                    <div class="row gy-30">
                        <div class="col-xl-3 col-lg-3 col-md-4">
                            <div class="bd-dashboard-menu">
                                <h6 class="bd-dashboard-menu-title mt-0">Welcome, aziz</h6>
                                <ul>
                                    <li>
                                        <a href="student-dashboard.html"><span><i class="fa-light fa-gauge-high"></i></span>Dashboard</a>
                                    </li>
                                    <li>
                                        <a href="student-profile.html"><span><i class="fa-light fa-id-badge"></i></span>My Profile</a>
                                    </li>
                                    <li>
                                        <a href="student-analytics.html"><span><i class="fa-light fa-chart-line"></i></span>Analytics</a>
                                    </li>
                                    <li>
                                        <a href="student-enrolled-courses.html"><span><i class="fa-light fa-book-reader"></i></span>Enrolled Courses</a>
                                    </li>
                                    <li>
                                        <a href="student-books.html"><span><i class="fa-light fa-book"></i></span>My Books</a>
                                    </li>
                                    <li>
                                        <a href="student-wishlist.html"><span><i class="fa-light fa-heart"></i></span>Wishlist</a>
                                    </li>
                                    <li>
                                        <a href="student-my-quiz-attempts.html"><span><i class="fa-light fa-file-lines"></i></span>My Quiz Attempts</a>
                                    </li>
                                    <li>
                                        <a href="student-assignments.html"><span><i class="fa-light fa-tasks"></i></span>Assignments</a>
                                    </li>
                                    <li>
                                        <a href="student-reviews.html"><span><i class="fa-light fa-comment-dots"></i></span>Reviews</a>
                                    </li>
                                    <li>
                                        <a href="student-purchase-history.html"><span><i class="fa-light fa-receipt"></i></span>Purchase History</a>
                                    </li>
                                    <li>
                                        <a href="student-announcements.html"><span><i class="fa-light fa-bullhorn"></i></span>Announcement</a>
                                    </li>
                                    <li>
                                        <a href="student-certificate.html"><span><i class="fa-light fa-award"></i></span>My Achievement</a>
                                    </li>
                                    <li>
                                        <a routerLink="/reclamation"><span><i class="fa-light fa-award"></i></span>Reclamation</a>
                                    </li>
                                     <li>
                                    <a routerLink="/admin/tickets"><span><i class="fa-light fa-envelope-open-text"></i></span>Manage Tickets</a>
                                    </li>
                                </ul>
                                <h6 class="bd-dashboard-menu-title">User</h6>
                                <ul>
                                    <li>
                                        <a href="student-settings.html"><span><i class="fa-light fa-sliders"></i></span>Settings</a>
                                    </li>
                                    <li>
                                        <a href="index.html"><span><i class="fa-light fa-sign-out-alt"></i></span>Logout</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-xl-9 col-lg-9 col-md-8">
                          <div class="bd-dashboard-inner">
                              <div class="bd-dashboard-status-box mb-30">
                                  <div class="bd-dashboard-title-inner">
                                      <h4 class="bd-dashboard-title">Complaints Statistics</h4>
                                  </div>
                                  <div class="container p-0">
                                      <div class="row gy-30 justify-content-center">
                                          <div class="col-xl-4 col-lg-4 col-md-6 col-sm-6">
                                              <div class="bd-counter-wrapper bd-counter-style-six">
                                                  <div class="bd-counter-item">
                                                      <div class="bd-counter-content">
                                                          <span class="bd-counter-icon bg-two"><i class="fa-solid fa-book-open"></i></span>
                                                          <h2 class="bd-counter-title"><span class="purecounter">{{ statistics?.pendingCount }}</span></h2>
                                                          <p>Pending</p>
                                                      </div>
                                                  </div>
                                              </div>
                                          </div>
                                          <div class="col-xl-4 col-lg-4 col-md-6 col-sm-6">
                                              <div class="bd-counter-wrapper bd-counter-style-six">
                                                  <div class="bd-counter-item">
                                                      <div class="bd-counter-content">
                                                          <span class="bd-counter-icon bg-two"><i class="fa-solid fa-user-check"></i></span>
                                                          <h2 class="bd-counter-title"><span class="purecounter">{{ statistics?.solvedCount }}</span></h2>
                                                          <p>Solved</p>
                                                      </div>
                                                  </div>
                                              </div>
                                          </div>
                                          <div class="col-xl-4 col-lg-4 col-md-6 col-sm-6">
                                              <div class="bd-counter-wrapper bd-counter-style-six">
                                                  <div class="bd-counter-item">
                                                      <div class="bd-counter-content">
                                                          <span class="bd-counter-icon bg-two"><i class="fa-solid fa-book-reader"></i></span>
                                                          <h2 class="bd-counter-title"><span class="purecounter">{{ statistics?.declinedCount }}</span></h2>
                                                          <p>Declined</p>
                                                      </div>
                                                  </div>
                                              </div>
                                          </div>
                                          <div class="col-xl-4 col-lg-4 col-md-6 col-sm-6">
                                              <div class="bd-counter-wrapper bd-counter-style-six">
                                                  <div class="bd-counter-item">
                                                      <div class="bd-counter-content">
                                                          <span class="bd-counter-icon bg-two"><i class="fa-solid fa-book-reader"></i></span>
                                                          <h2 class="bd-counter-title"><span class="purecounter">{{ statistics?.totalComplaints }}</span></h2>
                                                          <p>Total Complaints</p>
                                                      </div>
                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>

                        <div class="col-xl-9 col-lg-9 col-md-8">

                          <div class="bd-dashboard-sort mb-30">

                            <div class="container" style="
                            display: flex;
                            flex-direction: row-reverse;
                            align-items: flex-start;
                            justify-content: space-between;
                        ">
                              <div class="d-flex align-items-center justify-content-between">
                                <div class="d-flex align-items-center gap-10">
                                    <span class="sort-label">Date:</span>
                                    <div class="btn-group" role="group">
                                      <button
                                      (click)="sortComplaints('asc')"
                                      class="bd-btn btn-outline-border-secondary sort-button"
                                      [class.active]="sortDirection === 'asc'">
                                      <i class="fa-solid fa-arrow-up-wide-short"></i>
                                      Asc
                                  </button>
                                  <button
                                      (click)="sortComplaints('desc')"
                                      class="bd-btn btn-outline-border-secondary sort-button"
                                      [class.active]="sortDirection === 'desc'">
                                      <i class="fa-solid fa-arrow-down-wide-short"></i>
                                      Desc
                                  </button>
                                    </div>
                                </div>
                            </div>
                              <div class="search-container">
                                <mat-form-field appearance="outline" class="search-field">
                                  <mat-label>Search</mat-label>
                                  <input
                                    matInput
                                    [(ngModel)]="searchTerm"
                                    placeholder="Search for Compalint."
                                    (keyup)="onSearchInput()"
                                    (keyup.enter)="searchComplaints()">
                                  <button
                                    *ngIf="searchTerm"
                                    matSuffix
                                    mat-icon-button
                                    aria-label="Clear"
                                    (click)="clearSearch()">
                                    <mat-icon>close</mat-icon>
                                  </button>
                                  <mat-icon matSuffix>search</mat-icon>
                                </mat-form-field>
                                <button mat-raised-button color="primary" (click)="searchComplaints()">Search</button>
                              </div>

                              <!-- Loading indicator for search -->
                              <div *ngIf="isSearching" class="loading-indicator">
                                <mat-spinner diameter="30"></mat-spinner> Searching...
                              </div>

                              <!-- No results message -->
                              <div *ngIf="filteredComplaints.length === 0 && !isSearching" class="no-results">
                                <mat-card>
                                  <mat-card-content>
                                    No complaints found matching your search criteria.
                                  </mat-card-content>
                                </mat-card>
                              </div>
                        </div>
                        <div class="d-flex justify-content-center" style="width: max-content;">
                            <div class="table-responsive">
                                <table class="table-modern" style="width: 1240px;">
                                    <thead>
                                        <tr>
                                            <th>Title</th>
                                            <th>Email</th>
                                            <th>Description</th>
                                            <th>Status</th>
                                            <th>Type</th>
                                            <th>Priority</th>
                                            <th>Date</th>
                                            <th style="display: flex; justify-content-between;">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ng-container *ngFor="let complaint of paginatedComplaints; let i = index">
                                            <!-- Main row with base data -->
                                            <tr (click)="toggleExpandedRow(i)" [class.expanded-row]="expandedIndex === i" class="clickable-row">
                                                <td>{{ complaint.title }}</td>
                                                <td>
                                                    <!-- Conditional display for anonymous emails -->
                                                    <span *ngIf="complaint.isAnonymous" class="anonymous-email">
                                                        <i class="fa-solid fa-user-secret" style="margin-right: 5px;"></i>
                                                        Anonyme
                                                    </span>
                                                    <span *ngIf="!complaint.isAnonymous">{{ complaint.mail }}</span>
                                                </td>
                                                <td class="description-cell">
                                                    <!-- Truncated description with tooltip -->
                                                    <span title="{{ complaint.description }}">
                                                        {{ complaint.description | slice:0:50 }}{{ complaint.description.length > 50 ? '...' : '' }}
                                                    </span>
                                                </td>
                                                <td [ngClass]="{
                                                    'status-solved': complaint.status === 'SOLVED',
                                                    'status-pending': complaint.status === 'PENDING',
                                                    'status-declined': complaint.status === 'DECLINED'
                                                }">{{ complaint.status }}</td>
                                                <td>{{ complaint.type }}</td>
                                                <td>
                                                    <span 
                                                        class="priority-badge" 
                                                        [ngClass]="getPriorityClass(complaint.priority)"
                                                    >
                                                        {{ complaint.priority }}
                                                    </span>
                                                </td>
                                                <td>{{ complaint.date | date:'dd/MM/yyyy' }}</td>
                                                <td>
                                                    <div class="btns" style="
                                                        display: flex;
                                                        justify-content: space-around;
                                                        align-items: center;
                                                    ">
                                                        <button aria-label="Delete complaint" (click)="deleteComplaint(complaint.idcomplaint); $event.stopPropagation()">
                                                            <i class="fa-solid fa-trash" aria-hidden="true" style="color: red;"></i>
                                                        </button>
                                                        <button aria-label="Decline complaint" (click)="declineComplaint(complaint.idcomplaint); $event.stopPropagation()">
                                                            <i class="fa-solid fa-x" aria-hidden="true" style="color: orange;"></i>
                                                        </button>
                                                    </div>
                                                    <button
                                                        (click)="respondToComplaint(complaint); $event.stopPropagation()"
                                                        class="action-button respond-button"
                                                        *ngIf="selectedComplaintId !== complaint.idcomplaint"
                                                    >
                                                        Respond
                                                    </button>
                                                    <app-response
                                                        *ngIf="selectedComplaintId === complaint.idcomplaint"
                                                        [complaintId]="complaint.idcomplaint!"
                                                        (submitResponse)="handleResponseSubmitted($event)"
                                                        (cancel)="handleResponseCancel()"
                                                    ></app-response>
                                                </td>
                                            </tr>
                                            
                                            <!-- Expanded row with full details -->
                                            <tr *ngIf="expandedIndex === i" class="expanded-details">
                                                <td colspan="8">
                                                    <div class="expanded-description">
                                                        <h4>Complete Description:</h4>
                                                        <p>{{ complaint.description }}</p>
                                                    </div>
                                                </td>
                                            </tr>
                                        </ng-container>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <style>
                            .anonymous-email {
                                background-color: #f8f9fa;
                                padding: 3px 8px;
                                border-radius: 4px;
                                color: #6c757d;
                                font-style: italic;
                                border-left: 3px solid #28a745;
                                display: inline-flex;
                                align-items: center;
                            }
                            
                            .description-cell {
                                max-width: 200px;
                                white-space: nowrap;
                                overflow: hidden;
                                text-overflow: ellipsis;
                                cursor: help;
                            }
                            
                            .table-modern {
                                width: 1240px;
                            }
                        
                            .priority-badge {
                                padding: 4px 8px;
                                border-radius: 12px;
                                font-size: 0.8em;
                                font-weight: bold;
                                display: inline-block;
                            }
                        
                            .priority-low {
                                background-color: #e6f3ff;
                                color: #0066cc;
                            }
                        
                            .priority-medium {
                                background-color: #fff3e0;
                                color: #ff9800;
                            }
                        
                            .priority-high {
                                background-color: #ffebee;
                                color: #f44336;
                            }
                        </style>

                              <!-- Pagination Controls -->
                              <div class="pagination-controls text-center">
                                  <button class="pagination-button" (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">Previous</button>
                                  <span class="pagination-info">Page {{ currentPage }}</span>
                                  <button class="pagination-button" (click)="changePage(currentPage + 1)" [disabled]="currentPage * itemsPerPage >= complaints.length">Next</button>
                              </div>
                          </div>
                      </div>
                        </div>
                        <!-- End of Reclamation Table Section -->
                      </div>
                    </div>
                </div>
            </div>
            </div>

        <!-- End student Dashboard Area -->

    </main>
    <div class="backtotop-wrap cursor-pointer">
        <svg class="backtotop-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
            <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98" />
        </svg>
    </div>


</body>

